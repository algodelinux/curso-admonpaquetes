<!doctype html>
<html lang="es">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>Uso desde la línea de comandos | Administración de paquetes en sistemas basados en Debian </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta name="author" content="enavas@algodelinux.com" />
<meta name="generator" content="eXeLearning 2.8.1 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>
<body class="exe-web-site" id="exe-node-234"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<header id="header" ><div id="headerContent">Administración de paquetes en sistemas basados en Debian</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Administración de paquetes en una red de equipos Ubuntu/Debian</a></li>
   <li><a href="introduccin.html" class="no-ch">Introducción</a></li>
   <li><a href="preparacin_del_entorno_de_trabajo.html" class="daddy">Preparación del entorno de trabajo</a>
   <ul class="other-section">
      <li><a href="descarga_de_virtualbox.html" class="no-ch">Descarga de VirtualBox</a></li>
      <li><a href="instalacin_de_virtualbox.html" class="daddy">Instalación de VirtualBox</a>
      <ul class="other-section">
         <li><a href="instalacin_de_virtualbox_en_ubuntu_2204_desde_el_entorno_grfico.html" class="no-ch">Instalación de VirtualBox en Ubuntu 22.04 desde el entorno gráfico</a></li>
         <li><a href="instalacin_de_virtualbox_en_ubuntu_desde_los_repositorios_de_virtualbox.html" class="no-ch">Instalación de VirtualBox en Ubuntu desde los repositorios de VirtualBox</a></li>
         <li><a href="instalacin_de_virtualbox_en_windows.html" class="no-ch">Instalación de VirtualBox en Windows</a></li>
      </ul>
      </li>
      <li><a href="el_modo_red_nat.html" class="no-ch">El modo red NAT</a></li>
      <li><a href="acceso_ssh_en_modo_red_nat.html" class="no-ch">Acceso ssh en modo red NAT</a></li>
      <li><a href="actividad_1.html" class="no-ch">Actividad 1</a></li>
      <li><a href="importar_una_mquina_virtual.html" class="no-ch">Importar una máquina virtual</a></li>
      <li><a href="exportar_una_mquina_virtual.html" class="no-ch">Exportar una máquina virtual</a></li>
      <li><a href="actividad_2.html" class="no-ch">Actividad 2</a></li>
      <li><a href="crear_una_mquina_virtual.html" class="no-ch">Crear una máquina virtual</a></li>
      <li><a href="actividad_3.html" class="no-ch">Actividad 3</a></li>
      <li><a href="clonar_una_mquina_virtual.html" class="no-ch">Clonar una máquina virtual</a></li>
      <li><a href="actividad_4.html" class="no-ch">Actividad 4</a></li>
   </ul>
   </li>
   <li><a href="instalacin_mnima_de_xubuntu.html" class="daddy">Instalación mínima de Xubuntu</a>
   <ul class="other-section">
      <li><a href="requisitos_para_instalar_xubuntu.html" class="no-ch">Requisitos para instalar Xubuntu</a></li>
      <li><a href="descarga_de_xubuntu.html" class="no-ch">Descarga de Xubuntu</a></li>
      <li><a href="crear_un_pendrive_de_instalacin_de_xubuntu_utilizando_dd.html" class="no-ch">Crear un pendrive de instalación de Xubuntu utilizando dd</a></li>
      <li><a href="crear_un_pendrive_de_instalacin_de_xubuntu_usando_etcher.html" class="no-ch">Crear un pendrive de instalación de Xubuntu usando Etcher</a></li>
      <li><a href="instalacin_de_xubuntu_desktop.html" class="no-ch">Instalación de Xubuntu Desktop</a></li>
      <li><a href="actividad_5.html" class="no-ch">Actividad 5</a></li>
      <li><a href="configurar_acceso_remoto_mediante_ssh.html" class="no-ch">Configurar acceso remoto mediante ssh</a></li>
      <li><a href="actividad_6.html" class="no-ch">Actividad 6</a></li>
      <li><a href="paquetes_para_configurar_un_escritorio_educativo.html" class="daddy">Paquetes para configurar un "escritorio educativo"</a>
      <ul class="other-section">
         <li><a href="el_paquete_linexxubuntucore.html" class="no-ch">El paquete linex-xubuntu-core</a></li>
         <li><a href="el_paquete_linexconfigldapclient.html" class="no-ch">El paquete linex-config-ldapclient</a></li>
         <li><a href="el_paquete_linexubuntupuppet.html" class="no-ch">El paquete linex-ubuntu-puppet</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="gestin_automatizada_de_paquetes.html" class="current-page-parent daddy">Gestión automatizada de paquetes</a>
   <ul>
      <li><a href="gestin_de_paquetes_mediante_apt.html" class="daddy">Gestión de paquetes mediante apt</a>
      <ul class="other-section">
         <li><a href="actividad_7.html" class="no-ch">Actividad 7</a></li>
      </ul>
      </li>
      <li><a href="gestionar_los_repositorios_de_nuestra_distribucin.html" class="daddy">Gestionar los repositorios de nuestra distribución</a>
      <ul class="other-section">
         <li><a href="aadir_un_nuevo_repositorio.html" class="no-ch">Añadir un nuevo repositorio</a></li>
         <li><a href="eliminar_un_repositorio.html" class="no-ch">Eliminar un repositorio</a></li>
         <li><a href="aadir_un_repositorio_personal.html" class="no-ch">Añadir un repositorio personal</a></li>
         <li><a href="eliminar_el_repositorio_personal.html" class="no-ch">Eliminar el repositorio personal</a></li>
         <li><a href="actividad_8.html" class="no-ch">Actividad 8</a></li>
      </ul>
      </li>
      <li><a href="gestin_de_actualizaciones_mediante_unattendedupgrades.html" class="daddy">Gestión de actualizaciones mediante unattended-upgrades</a>
      <ul class="other-section">
         <li><a href="aadir_repositorios_a_unattendedupgrades.html" class="no-ch">Añadir repositorios a unattended-upgrades</a></li>
         <li><a href="aadir_ppa_a_unattendedupgrades.html" class="no-ch">Añadir ppa a unattended-upgrades</a></li>
         <li><a href="bloquear_la_actualizacin_de_paquetes.html" class="no-ch">Bloquear la actualización de paquetes</a></li>
         <li><a href="otras_opciones_de_configuracin.html" class="no-ch">Otras opciones de configuración</a></li>
         <li><a href="configurar_unattendedupgrades_para_enviar_un_email_cuando_se_produzca_un_error.html" class="no-ch">Configurar unattended-upgrades para enviar un email cuando se produzca un error</a></li>
         <li><a href="comprobar_que_se_estn_realizando_las_actualizaciones.html" class="no-ch">Comprobar que se están realizando las actualizaciones</a></li>
         <li><a href="cmo_se_inicia_unattendedupgrades.html" class="daddy">¿Cómo se inicia unattended-upgrades?</a>
         <ul class="other-section">
            <li><a href="el_fichero_etcaptaptconfd10periodic.html" class="no-ch">El fichero  /etc/apt/apt.conf.d/10periodic</a></li>
            <li><a href="el_fichero__etcaptaptconfd20autoupgrades.html" class="no-ch">El fichero  /etc/apt/apt.conf.d/20auto-upgrades</a></li>
         </ul>
         </li>
         <li><a href="actividad_9.html" class="no-ch">Actividad 9</a></li>
      </ul>
      </li>
      <li><a href="gestin_de_paquetes_mediante_puppet.html" class="daddy">Gestión de paquetes mediante puppet</a>
      <ul class="other-section">
         <li><a href="el_recurso_package.html" class="no-ch">El recurso package</a></li>
         <li><a href="asegurar_que_un_paquete_se_encuentre_instalado.html" class="no-ch">Asegurar que un paquete se encuentre instalado</a></li>
         <li><a href="asegurar_que_un_paquete_se_encuentre_desinstalado.html" class="no-ch">Asegurar que un paquete se encuentre desinstalado</a></li>
         <li><a href="gestionar_un_conjunto_de_paquetes.html" class="no-ch">Gestionar un conjunto de paquetes</a></li>
         <li><a href="actividad_10.html" class="no-ch">Actividad 10</a></li>
      </ul>
      </li>
      <li class="current-page-parent"><a href="gestin_de_paquetes_mediante_pkgsync.html" class="current-page-parent daddy">Gestión de paquetes mediante pkgsync</a>
      <ul>
         <li><a href="funcionamiento.html" class="no-ch">Funcionamiento</a></li>
         <li><a href="cundo_y_cmo_se_ejecuta_pkgsync.html" class="no-ch">¿Cuándo y cómo se ejecuta pkgsync?</a></li>
         <li><a href="gua_de_estilo.html" class="no-ch">Guía de estilo</a></li>
         <li><a href="instalacin_de_pkgsync.html" class="no-ch">Instalación de pkgsync</a></li>
         <li><a href="actividad_11.html" class="no-ch">Actividad 11</a></li>
         <li><a href="creacin_de_listas_de_paquetes.html" class="no-ch">Creación de listas de paquetes</a></li>
         <li><a href="actividad_12.html" class="no-ch">Actividad 12</a></li>
         <li><a href="creacin_de_listas_musthave_en_etcpkgsyncmusthaved.html" class="no-ch">Creación de listas musthave en /etc/pkgsync/musthave.d</a></li>
         <li><a href="actividad_13.html" class="no-ch">Actividad 13</a></li>
         <li><a href="creacin_de_listas_mayhave_en_etcpkgsyncmayhaved.html" class="no-ch">Creación de listas mayhave en /etc/pkgsync/mayhave.d</a></li>
         <li><a href="actividad_14.html" class="no-ch">Actividad 14</a></li>
         <li><a href="creacin_de_listas_maynothave_en_etcpkgsyncmaynothaved.html" class="no-ch">Creación de listas maynothave en /etc/pkgsync/maynothave.d</a></li>
         <li><a href="actividad_15.html" class="no-ch">Actividad 15</a></li>
         <li><a href="minimizar_el_fichero_etcpkgsyncmusthave.html" class="no-ch">Minimizar el fichero /etc/pkgsync/musthave</a></li>
         <li><a href="actividad_16.html" class="no-ch">Actividad 16</a></li>
         <li><a href="limpiar_ficheros_de_pkgsync.html" class="no-ch">Limpiar ficheros de pkgsync</a></li>
         <li><a href="actividad_17.html" class="no-ch">Actividad 17</a></li>
         <li><a href="configuracin_del_comportamiento_por_defecto_de_pkgsync.html" class="daddy">Configuración del comportamiento por defecto de pkgsync</a>
         <ul class="other-section">
            <li><a href="variables_que_podemos_modificar.html" class="no-ch">Variables que podemos modificar</a></li>
         </ul>
         </li>
         <li class="current-page-parent"><a href="parmetros_de_pkgsync.html" class="current-page-parent daddy">Parámetros de pkgsync</a>
         <ul>
            <li id="active"><a href="uso_desde_la_lnea_de_comandos.html" class="active no-ch">Uso desde la línea de comandos</a></li>
         </ul>
         </li>
         <li><a href="actividad_18.html" class="no-ch">Actividad 18</a></li>
         <li><a href="inicio_de_pkgsync_desde_el_terminal_tty12.html" class="no-ch">Inicio de pkgsync desde el terminal tty12</a></li>
         <li><a href="instalacin_del_mdulo_puppetlabsapt.html" class="no-ch">Instalación del módulo puppetlabs-apt</a></li>
         <li><a href="actividad_19.html" class="no-ch">Actividad 19</a></li>
         <li><a href="gestin_de_paquetes_y_repositorios_mediante_el_mdulo_puppet_pkgsync.html" class="daddy">Gestión de paquetes y repositorios mediante el módulo puppet pkgsync</a>
         <ul class="other-section">
            <li><a href="initpp.html" class="no-ch">init.pp</a></li>
            <li><a href="sourcespp.html" class="no-ch">sources.pp</a></li>
         </ul>
         </li>
         <li><a href="buscar_insertar_y_eliminar_nombres_de_paquetes_en_los_ficheros_de_pkgsync.html" class="no-ch">Buscar, insertar y eliminar nombres de paquetes en los ficheros de pkgsync</a></li>
         <li><a href="actividad_20.html" class="no-ch">Actividad 20</a></li>
         <li><a href="otras_herramientas_incorporadas_en_el_paquete_pkgsync.html" class="no-ch">Otras herramientas incorporadas en el paquete pkgsync</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="creacin_bsica_de_paquetes_y_metapaquetes.html" class="daddy">Creación básica de paquetes y metapaquetes</a>
   <ul class="other-section">
      <li><a href="crear_las_variables_debemail_y_debfullname_y_agregarlas_al_fichero_bashrc.html" class="no-ch">Crear las variables DEBEMAIL y DEBFULLNAME y agregarlas al fichero ~/.bashrc</a></li>
      <li><a href="herramientas.html" class="daddy">Herramientas</a>
      <ul class="other-section">
         <li><a href="dpkg.html" class="no-ch">dpkg</a></li>
         <li><a href="aptfile.html" class="no-ch">apt-file</a></li>
         <li><a href="fakeroot.html" class="no-ch">fakeroot</a></li>
         <li><a href="devscripts.html" class="no-ch">devscripts</a></li>
         <li><a href="actividad_21.html" class="no-ch">Actividad 21</a></li>
      </ul>
      </li>
      <li><a href="relaciones_entre_paquetes.html" class="no-ch">Relaciones entre paquetes</a></li>
      <li><a href="reempaquetar_paquetes_utilizando_dpkgrepack.html" class="daddy">Reempaquetar paquetes utilizando dpkg-repack</a>
      <ul class="other-section">
         <li><a href="actividad_22.html" class="no-ch">Actividad 22</a></li>
      </ul>
      </li>
      <li><a href="manipular_paquetes_utilizando_dpkgdeb.html" class="daddy">Manipular paquetes utilizando dpkg-deb</a>
      <ul class="other-section">
         <li><a href="desempaquetar_un_paquete.html" class="no-ch">Desempaquetar un paquete</a></li>
         <li><a href="empaquetar_un_paquete.html" class="no-ch">Empaquetar un paquete</a></li>
         <li><a href="actividad_23.html" class="no-ch">Actividad 23</a></li>
      </ul>
      </li>
      <li><a href="crear_paquetes_y_metapaquetes_utilizando_equivs.html" class="daddy">Crear paquetes y metapaquetes utilizando equivs</a>
      <ul class="other-section">
         <li><a href="procedimiento_de_creacin_de_paquetes_y_metapaquetes.html" class="no-ch">Procedimiento de creación de paquetes y metapaquetes</a></li>
         <li><a href="ejemplo_de_creacin_de_un_metapaquete.html" class="no-ch">Ejemplo de creación de un metapaquete</a></li>
         <li><a href="ejemplo_de_creacin_de_un_paquete.html" class="no-ch">Ejemplo de creación de un paquete</a></li>
         <li><a href="actividad_24.html" class="no-ch">Actividad 24</a></li>
      </ul>
      </li>
      <li><a href="crear_de_paquetes_desde_cdigo_fuente_utilizando_checkinstall.html" class="daddy">Crear de paquetes desde código fuente utilizando checkinstall</a>
      <ul class="other-section">
         <li><a href="ejemplo_prctico_crear_el_paquete_megatools.html" class="no-ch">Ejemplo práctico: Crear el paquete megatools</a></li>
         <li><a href="actividad_25.html" class="no-ch">Actividad 25</a></li>
      </ul>
      </li>
      <li><a href="crear_paquetes_binarios_y_metapaquetes_utilizando_debreate.html" class="daddy">Crear paquetes binarios y metapaquetes utilizando debreate</a>
      <ul class="other-section">
         <li><a href="instalar_debreate.html" class="no-ch">Instalar Debreate</a></li>
         <li><a href="actividad_26.html" class="no-ch">Actividad 26</a></li>
         <li><a href="crear_metapaquetes_utilizando_debreate.html" class="no-ch">Crear metapaquetes utilizando debreate</a></li>
         <li><a href="actividad_27.html" class="no-ch">Actividad 27</a></li>
         <li><a href="crear_paquetes_binarios_utilizando_debreate.html" class="no-ch">Crear paquetes binarios utilizando debreate</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="creacin_y_gestin_de_un_repositorio_local.html" class="daddy">Creación y gestión de un repositorio local</a>
   <ul class="other-section">
      <li><a href="generar_un_par_de_claves_para_asegurar_repositorio.html" class="daddy">Generar un par de claves para asegurar repositorio</a>
      <ul class="other-section">
         <li><a href="actividad_28.html" class="no-ch">Actividad 28</a></li>
      </ul>
      </li>
      <li><a href="instalar_y_configurar_reprepro.html" class="daddy">Instalar y configurar reprepro</a>
      <ul class="other-section">
         <li><a href="actividad_29.html" class="no-ch">Actividad 29</a></li>
      </ul>
      </li>
      <li><a href="aadir_paquetes_al_repositorio.html" class="daddy">Añadir paquetes al repositorio</a>
      <ul class="other-section">
         <li><a href="el_script_addtorepository.html" class="no-ch">El script add-to-repository</a></li>
         <li><a href="actividad_30.html" class="no-ch">Actividad 30</a></li>
      </ul>
      </li>
      <li><a href="listar_paquetes_en_el_repositorio.html" class="daddy">Listar paquetes en el repositorio</a>
      <ul class="other-section">
         <li><a href="actividad_31.html" class="no-ch">Actividad 31</a></li>
      </ul>
      </li>
      <li><a href="eliminar_paquetes_del_repositorio.html" class="no-ch">Eliminar paquetes del repositorio</a></li>
      <li><a href="aadir_el_repositorio_local_a_nuestros_clientes.html" class="daddy">Añadir el repositorio local a nuestros clientes</a>
      <ul class="other-section">
         <li><a href="actividad_32.html" class="no-ch">Actividad 32</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="creacin_y_gestin_de_un_mirror_local.html" class="daddy">Creación y gestión de un mirror local</a>
   <ul class="other-section">
      <li><a href="instalacin_y_configuracin_de_aptmirror.html" class="no-ch">Instalación y configuración de apt-mirror</a></li>
      <li><a href="iniciar_y_detener_la_construccin_del_mirror.html" class="no-ch">Iniciar y detener la construcción del mirror</a></li>
      <li><a href="configurar_aptmirror_para_mirrorizar_repositorios_ubuntu.html" class="daddy">Configurar apt-mirror para mirrorizar repositorios Ubuntu</a>
      <ul class="other-section">
         <li><a href="actividad_33.html" class="no-ch">Actividad 33</a></li>
      </ul>
      </li>
      <li><a href="aadir_el_mirror_a_nuestros_clientes.html" class="daddy">Añadir el mirror a nuestros clientes</a>
      <ul class="other-section">
         <li><a href="actividad_34.html" class="no-ch">Actividad 34</a></li>
      </ul>
      </li>
      <li><a href="crear_una_entrada_dns_en_el_servidor.html" class="no-ch">Crear una entrada DNS en el servidor</a></li>
   </ul>
   </li>
   <li><a href="anexo_1_grabar_sesiones_de_terminal.html" class="no-ch">Anexo 1. Grabar sesiones de terminal</a></li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="parmetros_de_pkgsync.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="actividad_18.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">Uso desde la línea de comandos</h1></header>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id313">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Forzar la ejecución de pkgsync</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta313_313_2" class="block iDevice_content">
<div class="exe-text"><p>Como ya sabéis, podemos desactivar la ejecución de pkgsync agregando el valor <strong>ENABLE = "no"</strong> en el fichero de configuración <strong>/etc/default/pkgsync</strong>. Ahora bien, es posible ejecutar pkgsync estando desactivado mediante el parámetro -f, --force.</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -f</span><br /><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync --force</span></td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id314">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Evitar la sincronización con puppet desde pkgsync</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta314_314_2" class="block iDevice_content">
<div class="exe-text"><p>Pkgsync está pensado para realizar una sincronización con Puppet antes de instalar/desinstalar paquetes. El parámetro <strong>-n</strong>, <strong>--no-sincpuppet</strong> nos permite evitar la ejecución de puppet desde pkgsync. Ésto es algo especialmente interesante cuando estamos testeando las listas de paquetes de una máquina y no queremos que Puppet las reemplace.</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -n<br />   # /usr/sbin/pkgsync --no-sincpuppet</span></td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id310">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Asegurar paquetes esenciales</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta310_310_2" class="block iDevice_content">
<div class="exe-text"><p>Para asegurar que no se desinstalan paquetes esenciales al ejecutar pkgsync, podemos usar el parámetro <strong>-e</strong>, <strong>--ensure-essential</strong>.</p>
<p>Los <strong>paquetes esenciales</strong> son los que se encuentran clasificados en el sistema como <strong>required</strong>, <strong>important</strong> o <strong>standard packages</strong>.</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -e</span><br /><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync --ensure-essential</span></td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id236">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Asegurarse de que la combinación de listas de paquetes no provoquen efectos indeseables</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta236_232_2" class="block iDevice_content">
<div class="exe-text"><p class="standard" id="magicparlabel-18037">Cuando vamos añadiendo paquetes a los diferentes ficheros utilizados por pkgsync para instalar/desinstalar software, es posible que provoquemos algún efecto indeseable, sobre todo cuando la gestión de estos ficheros es compartida por varios sysadmins.</p>
<p class="standard">Para evitar posibles problemas, es <strong>importante</strong> asegurarse de que, siempre que vayamos a añadir nuevos paquetes, la combinación de las listas de paquetes no provoquen efectos indeseables. Para ello, contamos con dos parámetros ("<strong>-s</strong>" y "<strong>-t</strong>"):</p>
<ul class="itemize" id="magicparlabel-18038">
<li class="itemize_item">
<p><b>-s, --simulate</b>: Simular la ejecución de pkgsync.</p>
</li>
<li class="itemize_item"><b>-t, --test-files</b>: Testear los ficheros de listas de paquetes. Permite comprobar si alguno de los ficheros de pkgsync contiene paquetes que no se encuentran disponibles en los repositorios utilizando el parámetro <b>-t,–test-files</b>. Al ejecutar <b>pkgsync -t </b>o <b>pkgsync –test-files</b>: 
<ul>
<li class="itemize_item">
<p>Se muestra por pantalla la lista de paquetes especificados en los ficheros de pkgsync que no se encuentran en los repositorios, informando acerca de en qué fichero se encuentra listado el paquete.</p>
</li>
<li class="itemize_item">
<p>Además, lo almacena en el siguiente fichero de log: <b>/var/log/pkgsync/removefromlists.log</b></p>
</li>
</ul>
</li>
<li class="itemize_item">
<p><b>-tr, --test-files r</b>: El parámetro "<strong>-t</strong>" tiene una opción ("<strong>r</strong>") que permite testear los ficheros de listas de paquetes y eliminar de los mismos aquellos paquetes que no se encuentren en los repositorios. Al ejecutar <b>pkgsync -tr </b>o <b>pkgsync –test-files r</b>:</p>
<ul>
<li class="itemize_item">
<p>Se muestra por pantalla la lista de paquetes especificados en los ficheros de pkgsync que no se encuentran en los repositorios.</p>
</li>
<li class="itemize_item">
<p>Se eliminan de las listas de paquetes de pkgsync aquellos paquetes que no se encuentran en los repositorios.</p>
</li>
<li class="itemize_item">
<p>Almacena los nombres de los paquetes eliminados en el siguiente fichero de log: <b>/var/log/pkgsync/removedfromlists.log</b></p>
</li>
</ul>
</li>
</ul>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -s</span> (Realizamos una simulación)<br /><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -t</span> (Testeamos los ficheros de listas de paquetes de pkgsync)<br /><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -tr</span> (Testeamos los ficheros de listas de paquetes de pkgsync y eliminamos de las listas los paquetes que no existan)</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id311">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Eliminar ficheros de listas de paquetes</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta311_311_2" class="block iDevice_content">
<div class="exe-text"><p>Si necesitamos hacer limpieza para reconfigurar las listas de paquetes, podemos usar pkgsync con el parámetro <strong>-d</strong> o <strong>--delete-files</strong>.</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -d</span><br /><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync --delete-files</span></td>
</tr>
</tbody>
</table>
<p>Esta opción buscará todos los ficheros de listas de paquetes que haya dentro del directorio <strong>/etc/pkgsync</strong> y los eliminará.</p></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id312">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Crear ficheros de listas de paquetes</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta312_312_2" class="block iDevice_content">
<div class="exe-text"><p>Si la opción anterior nos permitía eliminar todos los ficheros de listas de paquetes, la opción<strong> -b</strong> o <strong>--build-files</strong> permite crear los<strong> ficheros esenciales</strong> de listas de paquetes de pkgsync. Básicamente lo que hace es, si no existen:</p>
<ul>
<li>Generar un nuevo fichero /etc/pkgsync/musthave basándose en los paquetes instalados en el sistema.</li>
<li>Crear un nuevo fichero /etc/pkgsync/mayhave.</li>
<li>Crear un nuevo fichero /etc/pkgsync/maynothave.</li>
</ul>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -b</span><br /><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync --build-files</span></td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id237">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Garantizar que el usuario no pueda apagar o reiniciar la máquina mientras se está ejecutando pkgsync</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta237_233_2" class="block iDevice_content">
<div class="exe-text"><p class="standard" id="magicparlabel-21867">Es posible que el usuario trate de apagar la máquina o reiniciarla mientras se está realizando una actualización de paquetes mediante pkgsync, algo que puede producir errores en los mismos.</p>
<div class="standard" id="magicparlabel-23779">Para evitar que el usuario pueda apagar el equipo mientras se está ejecutando pkgsync, pkgsync tiene un wrapper (<b>/usr/sbin/pkgsync</b>) que hace uso de <b>systemd-inhibit</b> para inhibir el apagado. Por tanto, si queréis evitar que el usuario pueda apagar o reiniciar la máquina mientras se está ejecutando pkgsync, en lugar de realizar un pkgsync mediante el script <b>/usr/local/sbin/pkgsync</b>, deberíais hacerlo mediante el wrapper <b>/usr/sbin/pkgsync</b>.</div>
<div class="standard"></div>
<div class="standard">
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync</span></td>
</tr>
</tbody>
</table>
</div></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id238">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Eliminar kernels antiguos</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta238_234_2" class="block iDevice_content">
<div class="exe-text"><p class="standard" id="magicparlabel-23816">Podemos eliminar kernels antiguos dejando los dos más recientes (opción por defecto de purge-old-kernels) o el número que se indique en el fichero de configuración <b>/etc/default/pkgsync:</b></p>
<ul class="itemize" id="magicparlabel-23817">
<li class="itemize_item">
<p>Utilizando la opción <b>-p</b>, <b>--purge-old-kernels</b> de <strong>pkgsync</strong>.</p>
</li>
<li class="itemize_item">
<p>Ejecutando el script <strong>purge-old-kernels</strong> que viene con el paquete pkgsync.</p>
</li>
</ul>
<p><br style="clear: both;" />Utilizando <strong>pkgsync</strong>:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -p</span></td>
</tr>
</tbody>
</table>
<p>pkgsync eliminará todos los kernels antiguos salvo los últimos kernels instalados. Recordad que podéis modificar la variable  KEEP_LAST_KERNELS en el fichero /etc/default/pkgsync para indicar el número de kernels más recientes que deben mantenerse. Por ejemplo: KEEP_LAST_KERNELS="3" mantendrá los tres últimos kernels instalados.</p>
<p><br style="clear: both;" />Utilizando <strong>purge-old-kernels</strong>:</p>
<table style="width: 100%; height: 28px;" class="exe-table" border="1">
<tbody>
<tr style="height: 28px;">
<td style="width: 100%; height: 28px;"><span style="font-family: terminal, monaco, monospace;">   # purge-old-kernels</span> (Eliminará todos los kernels salvo los dos últimos que se hayan instalado)<br /><span style="font-family: terminal, monaco, monospace;">   # purge-old-kernels --keep 3</span> (Eliminará todos los kernels salvo los tres últimos instalados)</td>
</tr>
</tbody>
</table>
<p>Si queréis, podéis echar un vistazo al script <a href="https://github.com/algodelinux/purge-old-kernels">purge-old-kernels</a>.</p></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id231">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Eliminar dependencias de paquetes desinstalados, rastro de paquetes desinstalados y limpiar la caché</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta231_235_2" class="block iDevice_content">
<div class="exe-text"><p>Podemos realizar limpieza de paquetes eliminando dependencias de paquetes desinstalados, restos de paquetes desinstalados y limpiando la caché de dos formas:<br /><span class="paragraph_label"></span></p>
<ul class="itemize" id="magicparlabel-25744">
<li class="itemize_item">
<p>Utilizando la opción <b>-c</b>, <b>--clean</b> de pkgsync.</p>
</li>
<li class="itemize_item">
<p>Ejecutando el script <b>limpiapaquetes</b> que viene con el paquete pkgsync.</p>
</li>
</ul>
<p>Utilizando <strong>pkgsync</strong>:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -c</span></td>
</tr>
</tbody>
</table>
<p>Utilizando el script <strong>limpiapaquetes</strong>:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # limpiapaquetes</span></td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id315">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Evitar que se aborte la ejecución</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta315_315_2" class="block iDevice_content">
<div class="exe-text"><p>Como ya mencionamos cuando hablamos del fichero de configuración <strong>/etc/default/pkgsync</strong>, pkgsync usa <strong>aptitude</strong> para instalar/desinstalar paquetes, y, a partir de una determinada versión, los desarrolladores de aptitude realizaron una modificación que hace que aptitude aborte cuando se le pide realizar una instalación de un paquete que no se encuentra en los repositorios. Para evitar este efecto indeseable cuando iniciamos pkgsync desde la línea de comandos, podemos usar el parámetro <strong>-i, --ignore-failed-repos</strong>:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -i</span><br /><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync --ignore-failed-repos</span></td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id232">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Obtener claves públicas de repositorios</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta232_236_2" class="block iDevice_content">
<div class="exe-text"><p>Podemos obtener automáticamente las claves públicas de los repositorios que nos falten:<br /><span class="paragraph_label"></span></p>
<ul class="itemize" id="magicparlabel-25770">
<li class="itemize_item">
<p>Utilizando la opción <b>-g, --get-keys</b> de pkgsync.</p>
</li>
<li class="itemize_item">
<p>Ejecutando el script <b>launchpad-getkeys</b> que viene con el paquete pkgsync.</p>
</li>
</ul>
<p class="standard">Utilizando <strong>pkgsync</strong>:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -g</span><br /><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync --get-keys</span></td>
</tr>
</tbody>
</table>
<p class="standard">Utilizando el script <strong>launchpad-getkeys</strong>:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # launchpad-getkeys</span></td>
</tr>
</tbody>
</table>
<p class="standard" id="magicparlabel-25772">En el fichero de configuración <strong>/etc/default/pkgsync</strong> encontraréis definida una variable que permite definir un proxy para que la herramienta que obtiene las claves pueda descargarlas. Nosotros hemos utilizamos el proxy squid que tenemos en todos los centros asignando el valor <strong>http://servidor:3128</strong> a la variable <strong>LAUNCHPAD_GETKEYS_PROXY</strong><b></b>: </p>
<p class="standard"><strong>LAUNCHPAD_GETKEYS_PROXY</strong><b>="http://servidor:3128"</b></p>
<p class="standard">Si no utilizamos un proxy, launchpad-getkeys no puede obtener las claves públicas de los repositorios en nuestra intranet.</p>
<p class="standard">Si no necesitáis usar un proxy, podéis dejar vacío el valor de esta variable:</p>
<p class="standard"><strong>LAUNCHPAD_GETKEYS_PROXY</strong><b>=""</b></p></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id316">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Apagar la máquina al terminar</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta316_316_2" class="block iDevice_content">
<div class="exe-text"><p>El parámetro <strong>-S, --shutdown</strong> permite que se apague la máquina al terminar la ejecución de pkgsync. Ésto es especialmente útil cuando iniciamos pkgsync pero queremos marcharnos sin esperar a que termine, o cuando programamos la ejecución de pkgsync fuera del horario de trabajo.</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -S</span><br /><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync --shutdown</span></td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id317">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Reiniciar la máquina al terminar</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta317_317_2" class="block iDevice_content">
<div class="exe-text"><p>El parámetro <strong>-R, --reboot</strong> permite reiniciar la máquina al terminar.</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -R</span><br /><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync --reboot</span></td>
</tr>
</tbody>
</table>
<p></p></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_puzzle" id="id318">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_puzzle.png)"><h1 class="iDeviceTitle">Reiniciar e iniciar Windows al terminar</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta318_318_2" class="block iDevice_content">
<div class="exe-text"><p>El parámetro <strong>-R, --reboot</strong> tiene una opción <strong>w</strong> que permite, en un equipo con arranque <strong>EFI</strong>, iniciar Windows tras reiniciar. Agregamos esta opción para automatizar las actualización de los dos sistemas operativos en un equipo con arranque dual Ubuntu/Windows.</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync -Rw</span><br /><span style="font-family: terminal, monaco, monospace;">   # /usr/sbin/pkgsync --reboot w</span></td>
</tr>
</tbody>
</table>
<p></p></div>
</div>
</div>
</div>
</div>
</article>
</section>
</div>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="parmetros_de_pkgsync.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="actividad_18.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
</div>
<p id="made-with-eXe"><a href="https://exelearning.net/" target="_blank" rel="noopener"><span>Creado con eXeLearning<span> (Ventana nueva)</span></span></a></p><script type="text/javascript" src="_style_js.js"></script></body></html>