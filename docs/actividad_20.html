<!doctype html>
<html lang="es">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>Actividad 20 | Administración de paquetes en sistemas basados en Debian </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta name="author" content="enavas@algodelinux.com" />
<meta name="generator" content="eXeLearning 2.8.1 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>
<body class="exe-web-site" id="exe-node-241"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<header id="header" ><div id="headerContent">Administración de paquetes en sistemas basados en Debian</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Administración de paquetes en una red de equipos Ubuntu/Debian</a></li>
   <li><a href="introduccin.html" class="no-ch">Introducción</a></li>
   <li><a href="preparacin_del_entorno_de_trabajo.html" class="daddy">Preparación del entorno de trabajo</a>
   <ul class="other-section">
      <li><a href="descarga_de_virtualbox.html" class="no-ch">Descarga de VirtualBox</a></li>
      <li><a href="instalacin_de_virtualbox.html" class="daddy">Instalación de VirtualBox</a>
      <ul class="other-section">
         <li><a href="instalacin_de_virtualbox_en_ubuntu_2204_desde_el_entorno_grfico.html" class="no-ch">Instalación de VirtualBox en Ubuntu 22.04 desde el entorno gráfico</a></li>
         <li><a href="instalacin_de_virtualbox_en_ubuntu_desde_los_repositorios_de_virtualbox.html" class="no-ch">Instalación de VirtualBox en Ubuntu desde los repositorios de VirtualBox</a></li>
         <li><a href="instalacin_de_virtualbox_en_windows.html" class="no-ch">Instalación de VirtualBox en Windows</a></li>
      </ul>
      </li>
      <li><a href="el_modo_red_nat.html" class="no-ch">El modo red NAT</a></li>
      <li><a href="acceso_ssh_en_modo_red_nat.html" class="no-ch">Acceso ssh en modo red NAT</a></li>
      <li><a href="actividad_1.html" class="no-ch">Actividad 1</a></li>
      <li><a href="importar_una_mquina_virtual.html" class="no-ch">Importar una máquina virtual</a></li>
      <li><a href="exportar_una_mquina_virtual.html" class="no-ch">Exportar una máquina virtual</a></li>
      <li><a href="actividad_2.html" class="no-ch">Actividad 2</a></li>
      <li><a href="crear_una_mquina_virtual.html" class="no-ch">Crear una máquina virtual</a></li>
      <li><a href="actividad_3.html" class="no-ch">Actividad 3</a></li>
      <li><a href="clonar_una_mquina_virtual.html" class="no-ch">Clonar una máquina virtual</a></li>
      <li><a href="actividad_4.html" class="no-ch">Actividad 4</a></li>
   </ul>
   </li>
   <li><a href="instalacin_mnima_de_xubuntu.html" class="daddy">Instalación mínima de Xubuntu</a>
   <ul class="other-section">
      <li><a href="requisitos_para_instalar_xubuntu.html" class="no-ch">Requisitos para instalar Xubuntu</a></li>
      <li><a href="descarga_de_xubuntu.html" class="no-ch">Descarga de Xubuntu</a></li>
      <li><a href="crear_un_pendrive_de_instalacin_de_xubuntu_utilizando_dd.html" class="no-ch">Crear un pendrive de instalación de Xubuntu utilizando dd</a></li>
      <li><a href="crear_un_pendrive_de_instalacin_de_xubuntu_usando_etcher.html" class="no-ch">Crear un pendrive de instalación de Xubuntu usando Etcher</a></li>
      <li><a href="instalacin_de_xubuntu_desktop.html" class="no-ch">Instalación de Xubuntu Desktop</a></li>
      <li><a href="actividad_5.html" class="no-ch">Actividad 5</a></li>
      <li><a href="configurar_acceso_remoto_mediante_ssh.html" class="no-ch">Configurar acceso remoto mediante ssh</a></li>
      <li><a href="actividad_6.html" class="no-ch">Actividad 6</a></li>
      <li><a href="paquetes_para_configurar_un_escritorio_educativo.html" class="daddy">Paquetes para configurar un "escritorio educativo"</a>
      <ul class="other-section">
         <li><a href="el_paquete_linexxubuntucore.html" class="no-ch">El paquete linex-xubuntu-core</a></li>
         <li><a href="el_paquete_linexconfigldapclient.html" class="no-ch">El paquete linex-config-ldapclient</a></li>
         <li><a href="el_paquete_linexubuntupuppet.html" class="no-ch">El paquete linex-ubuntu-puppet</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="gestin_automatizada_de_paquetes.html" class="current-page-parent daddy">Gestión automatizada de paquetes</a>
   <ul>
      <li><a href="gestin_de_paquetes_mediante_apt.html" class="daddy">Gestión de paquetes mediante apt</a>
      <ul class="other-section">
         <li><a href="actividad_7.html" class="no-ch">Actividad 7</a></li>
      </ul>
      </li>
      <li><a href="gestionar_los_repositorios_de_nuestra_distribucin.html" class="daddy">Gestionar los repositorios de nuestra distribución</a>
      <ul class="other-section">
         <li><a href="aadir_un_nuevo_repositorio.html" class="no-ch">Añadir un nuevo repositorio</a></li>
         <li><a href="eliminar_un_repositorio.html" class="no-ch">Eliminar un repositorio</a></li>
         <li><a href="aadir_un_repositorio_personal.html" class="no-ch">Añadir un repositorio personal</a></li>
         <li><a href="eliminar_el_repositorio_personal.html" class="no-ch">Eliminar el repositorio personal</a></li>
         <li><a href="actividad_8.html" class="no-ch">Actividad 8</a></li>
      </ul>
      </li>
      <li><a href="gestin_de_actualizaciones_mediante_unattendedupgrades.html" class="daddy">Gestión de actualizaciones mediante unattended-upgrades</a>
      <ul class="other-section">
         <li><a href="aadir_repositorios_a_unattendedupgrades.html" class="no-ch">Añadir repositorios a unattended-upgrades</a></li>
         <li><a href="aadir_ppa_a_unattendedupgrades.html" class="no-ch">Añadir ppa a unattended-upgrades</a></li>
         <li><a href="bloquear_la_actualizacin_de_paquetes.html" class="no-ch">Bloquear la actualización de paquetes</a></li>
         <li><a href="otras_opciones_de_configuracin.html" class="no-ch">Otras opciones de configuración</a></li>
         <li><a href="configurar_unattendedupgrades_para_enviar_un_email_cuando_se_produzca_un_error.html" class="no-ch">Configurar unattended-upgrades para enviar un email cuando se produzca un error</a></li>
         <li><a href="comprobar_que_se_estn_realizando_las_actualizaciones.html" class="no-ch">Comprobar que se están realizando las actualizaciones</a></li>
         <li><a href="cmo_se_inicia_unattendedupgrades.html" class="daddy">¿Cómo se inicia unattended-upgrades?</a>
         <ul class="other-section">
            <li><a href="el_fichero_etcaptaptconfd10periodic.html" class="no-ch">El fichero  /etc/apt/apt.conf.d/10periodic</a></li>
            <li><a href="el_fichero__etcaptaptconfd20autoupgrades.html" class="no-ch">El fichero  /etc/apt/apt.conf.d/20auto-upgrades</a></li>
         </ul>
         </li>
         <li><a href="actividad_9.html" class="no-ch">Actividad 9</a></li>
      </ul>
      </li>
      <li><a href="gestin_de_paquetes_mediante_puppet.html" class="daddy">Gestión de paquetes mediante puppet</a>
      <ul class="other-section">
         <li><a href="el_recurso_package.html" class="no-ch">El recurso package</a></li>
         <li><a href="asegurar_que_un_paquete_se_encuentre_instalado.html" class="no-ch">Asegurar que un paquete se encuentre instalado</a></li>
         <li><a href="asegurar_que_un_paquete_se_encuentre_desinstalado.html" class="no-ch">Asegurar que un paquete se encuentre desinstalado</a></li>
         <li><a href="gestionar_un_conjunto_de_paquetes.html" class="no-ch">Gestionar un conjunto de paquetes</a></li>
         <li><a href="actividad_10.html" class="no-ch">Actividad 10</a></li>
      </ul>
      </li>
      <li class="current-page-parent"><a href="gestin_de_paquetes_mediante_pkgsync.html" class="current-page-parent daddy">Gestión de paquetes mediante pkgsync</a>
      <ul>
         <li><a href="funcionamiento.html" class="no-ch">Funcionamiento</a></li>
         <li><a href="cundo_y_cmo_se_ejecuta_pkgsync.html" class="no-ch">¿Cuándo y cómo se ejecuta pkgsync?</a></li>
         <li><a href="gua_de_estilo.html" class="no-ch">Guía de estilo</a></li>
         <li><a href="instalacin_de_pkgsync.html" class="no-ch">Instalación de pkgsync</a></li>
         <li><a href="actividad_11.html" class="no-ch">Actividad 11</a></li>
         <li><a href="creacin_de_listas_de_paquetes.html" class="no-ch">Creación de listas de paquetes</a></li>
         <li><a href="actividad_12.html" class="no-ch">Actividad 12</a></li>
         <li><a href="creacin_de_listas_musthave_en_etcpkgsyncmusthaved.html" class="no-ch">Creación de listas musthave en /etc/pkgsync/musthave.d</a></li>
         <li><a href="actividad_13.html" class="no-ch">Actividad 13</a></li>
         <li><a href="creacin_de_listas_mayhave_en_etcpkgsyncmayhaved.html" class="no-ch">Creación de listas mayhave en /etc/pkgsync/mayhave.d</a></li>
         <li><a href="actividad_14.html" class="no-ch">Actividad 14</a></li>
         <li><a href="creacin_de_listas_maynothave_en_etcpkgsyncmaynothaved.html" class="no-ch">Creación de listas maynothave en /etc/pkgsync/maynothave.d</a></li>
         <li><a href="actividad_15.html" class="no-ch">Actividad 15</a></li>
         <li><a href="minimizar_el_fichero_etcpkgsyncmusthave.html" class="no-ch">Minimizar el fichero /etc/pkgsync/musthave</a></li>
         <li><a href="actividad_16.html" class="no-ch">Actividad 16</a></li>
         <li><a href="limpiar_ficheros_de_pkgsync.html" class="no-ch">Limpiar ficheros de pkgsync</a></li>
         <li><a href="actividad_17.html" class="no-ch">Actividad 17</a></li>
         <li><a href="configuracin_del_comportamiento_por_defecto_de_pkgsync.html" class="daddy">Configuración del comportamiento por defecto de pkgsync</a>
         <ul class="other-section">
            <li><a href="variables_que_podemos_modificar.html" class="no-ch">Variables que podemos modificar</a></li>
         </ul>
         </li>
         <li><a href="parmetros_de_pkgsync.html" class="daddy">Parámetros de pkgsync</a>
         <ul class="other-section">
            <li><a href="uso_desde_la_lnea_de_comandos.html" class="no-ch">Uso desde la línea de comandos</a></li>
         </ul>
         </li>
         <li><a href="actividad_18.html" class="no-ch">Actividad 18</a></li>
         <li><a href="inicio_de_pkgsync_desde_el_terminal_tty12.html" class="no-ch">Inicio de pkgsync desde el terminal tty12</a></li>
         <li><a href="instalacin_del_mdulo_puppetlabsapt.html" class="no-ch">Instalación del módulo puppetlabs-apt</a></li>
         <li><a href="actividad_19.html" class="no-ch">Actividad 19</a></li>
         <li><a href="gestin_de_paquetes_y_repositorios_mediante_el_mdulo_puppet_pkgsync.html" class="daddy">Gestión de paquetes y repositorios mediante el módulo puppet pkgsync</a>
         <ul class="other-section">
            <li><a href="initpp.html" class="no-ch">init.pp</a></li>
            <li><a href="sourcespp.html" class="no-ch">sources.pp</a></li>
         </ul>
         </li>
         <li><a href="buscar_insertar_y_eliminar_nombres_de_paquetes_en_los_ficheros_de_pkgsync.html" class="no-ch">Buscar, insertar y eliminar nombres de paquetes en los ficheros de pkgsync</a></li>
         <li id="active"><a href="actividad_20.html" class="active no-ch">Actividad 20</a></li>
         <li><a href="otras_herramientas_incorporadas_en_el_paquete_pkgsync.html" class="no-ch">Otras herramientas incorporadas en el paquete pkgsync</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="creacin_bsica_de_paquetes_y_metapaquetes.html" class="daddy">Creación básica de paquetes y metapaquetes</a>
   <ul class="other-section">
      <li><a href="crear_las_variables_debemail_y_debfullname_y_agregarlas_al_fichero_bashrc.html" class="no-ch">Crear las variables DEBEMAIL y DEBFULLNAME y agregarlas al fichero ~/.bashrc</a></li>
      <li><a href="herramientas.html" class="daddy">Herramientas</a>
      <ul class="other-section">
         <li><a href="dpkg.html" class="no-ch">dpkg</a></li>
         <li><a href="aptfile.html" class="no-ch">apt-file</a></li>
         <li><a href="fakeroot.html" class="no-ch">fakeroot</a></li>
         <li><a href="devscripts.html" class="no-ch">devscripts</a></li>
         <li><a href="actividad_21.html" class="no-ch">Actividad 21</a></li>
      </ul>
      </li>
      <li><a href="relaciones_entre_paquetes.html" class="no-ch">Relaciones entre paquetes</a></li>
      <li><a href="reempaquetar_paquetes_utilizando_dpkgrepack.html" class="daddy">Reempaquetar paquetes utilizando dpkg-repack</a>
      <ul class="other-section">
         <li><a href="actividad_22.html" class="no-ch">Actividad 22</a></li>
      </ul>
      </li>
      <li><a href="manipular_paquetes_utilizando_dpkgdeb.html" class="daddy">Manipular paquetes utilizando dpkg-deb</a>
      <ul class="other-section">
         <li><a href="desempaquetar_un_paquete.html" class="no-ch">Desempaquetar un paquete</a></li>
         <li><a href="empaquetar_un_paquete.html" class="no-ch">Empaquetar un paquete</a></li>
         <li><a href="actividad_23.html" class="no-ch">Actividad 23</a></li>
      </ul>
      </li>
      <li><a href="crear_paquetes_y_metapaquetes_utilizando_equivs.html" class="daddy">Crear paquetes y metapaquetes utilizando equivs</a>
      <ul class="other-section">
         <li><a href="procedimiento_de_creacin_de_paquetes_y_metapaquetes.html" class="no-ch">Procedimiento de creación de paquetes y metapaquetes</a></li>
         <li><a href="ejemplo_de_creacin_de_un_metapaquete.html" class="no-ch">Ejemplo de creación de un metapaquete</a></li>
         <li><a href="ejemplo_de_creacin_de_un_paquete.html" class="no-ch">Ejemplo de creación de un paquete</a></li>
         <li><a href="actividad_24.html" class="no-ch">Actividad 24</a></li>
      </ul>
      </li>
      <li><a href="crear_de_paquetes_desde_cdigo_fuente_utilizando_checkinstall.html" class="daddy">Crear de paquetes desde código fuente utilizando checkinstall</a>
      <ul class="other-section">
         <li><a href="ejemplo_prctico_crear_el_paquete_megatools.html" class="no-ch">Ejemplo práctico: Crear el paquete megatools</a></li>
         <li><a href="actividad_25.html" class="no-ch">Actividad 25</a></li>
      </ul>
      </li>
      <li><a href="crear_paquetes_binarios_y_metapaquetes_utilizando_debreate.html" class="daddy">Crear paquetes binarios y metapaquetes utilizando debreate</a>
      <ul class="other-section">
         <li><a href="instalar_debreate.html" class="no-ch">Instalar Debreate</a></li>
         <li><a href="actividad_26.html" class="no-ch">Actividad 26</a></li>
         <li><a href="crear_metapaquetes_utilizando_debreate.html" class="no-ch">Crear metapaquetes utilizando debreate</a></li>
         <li><a href="actividad_27.html" class="no-ch">Actividad 27</a></li>
         <li><a href="crear_paquetes_binarios_utilizando_debreate.html" class="no-ch">Crear paquetes binarios utilizando debreate</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="creacin_y_gestin_de_un_repositorio_local.html" class="daddy">Creación y gestión de un repositorio local</a>
   <ul class="other-section">
      <li><a href="generar_un_par_de_claves_para_asegurar_repositorio.html" class="daddy">Generar un par de claves para asegurar repositorio</a>
      <ul class="other-section">
         <li><a href="actividad_28.html" class="no-ch">Actividad 28</a></li>
      </ul>
      </li>
      <li><a href="instalar_y_configurar_reprepro.html" class="daddy">Instalar y configurar reprepro</a>
      <ul class="other-section">
         <li><a href="actividad_29.html" class="no-ch">Actividad 29</a></li>
      </ul>
      </li>
      <li><a href="aadir_paquetes_al_repositorio.html" class="daddy">Añadir paquetes al repositorio</a>
      <ul class="other-section">
         <li><a href="el_script_addtorepository.html" class="no-ch">El script add-to-repository</a></li>
         <li><a href="actividad_30.html" class="no-ch">Actividad 30</a></li>
      </ul>
      </li>
      <li><a href="listar_paquetes_en_el_repositorio.html" class="daddy">Listar paquetes en el repositorio</a>
      <ul class="other-section">
         <li><a href="actividad_31.html" class="no-ch">Actividad 31</a></li>
      </ul>
      </li>
      <li><a href="eliminar_paquetes_del_repositorio.html" class="no-ch">Eliminar paquetes del repositorio</a></li>
      <li><a href="aadir_el_repositorio_local_a_nuestros_clientes.html" class="daddy">Añadir el repositorio local a nuestros clientes</a>
      <ul class="other-section">
         <li><a href="actividad_32.html" class="no-ch">Actividad 32</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="creacin_y_gestin_de_un_mirror_local.html" class="daddy">Creación y gestión de un mirror local</a>
   <ul class="other-section">
      <li><a href="instalacin_y_configuracin_de_aptmirror.html" class="no-ch">Instalación y configuración de apt-mirror</a></li>
      <li><a href="iniciar_y_detener_la_construccin_del_mirror.html" class="no-ch">Iniciar y detener la construcción del mirror</a></li>
      <li><a href="configurar_aptmirror_para_mirrorizar_repositorios_ubuntu.html" class="daddy">Configurar apt-mirror para mirrorizar repositorios Ubuntu</a>
      <ul class="other-section">
         <li><a href="actividad_33.html" class="no-ch">Actividad 33</a></li>
      </ul>
      </li>
      <li><a href="aadir_el_mirror_a_nuestros_clientes.html" class="daddy">Añadir el mirror a nuestros clientes</a>
      <ul class="other-section">
         <li><a href="actividad_34.html" class="no-ch">Actividad 34</a></li>
      </ul>
      </li>
      <li><a href="crear_una_entrada_dns_en_el_servidor.html" class="no-ch">Crear una entrada DNS en el servidor</a></li>
   </ul>
   </li>
   <li><a href="anexo_1_grabar_sesiones_de_terminal.html" class="no-ch">Anexo 1. Grabar sesiones de terminal</a></li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="buscar_insertar_y_eliminar_nombres_de_paquetes_en_los_ficheros_de_pkgsync.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="otras_herramientas_incorporadas_en_el_paquete_pkgsync.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">Actividad 20</h1></header>
<article class="iDevice_wrapper textIdevice em_iDevice em_iDevice_star" id="id249">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_star.png)"><h1 class="iDeviceTitle">Agregar el módulo pkgsync</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta249_249_2" class="block iDevice_content">
<div class="exe-text"><p><strong>Inicia </strong><span>la máquina virtual</span><strong><span> </span>puppetserver</strong><span> y abre un terminal.</span></p>
<p><span>Conéctate a la máquina virtual <strong>puppetserver</strong> mediante <strong>ssh</strong>.</span></p>
<p><span><strong>Instala</strong> el módulo <strong>puppetlabs-apt</strong> desde Puppet Forge.</span></p>
<p><span>Descarga el archivo <strong>pkgsync-module.tar.gz</strong> en la máquina virtual <strong>puppetserver</strong>:</span></p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # wget https://github.com/algodelinux/curso-admonpaquetes/raw/main/pkgsync-module.tar.gz</span></td>
</tr>
</tbody>
</table>
<p><span>Una vez descargado, <strong>descomprímelo</strong> en el directorio de módulos puppet:</span></p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # tar xvfz pkgsync-module.tar.gz -C /etc/puppetlabs/code/environments/production/modules/</span></td>
</tr>
</tbody>
</table>
<p><span>Si echas un vistazo al directorio <strong>/etc/puppetlabs/code/environments/production/modules/</strong>, verás que tienes un directorio <strong>pkgsync</strong> como el siguiente:</span></p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">pkgsync/</span><br /><span style="font-family: terminal, monaco, monospace;">├── files</span><br /><span style="font-family: terminal, monaco, monospace;">│   ├── add-apt-key</span><br /><span style="font-family: terminal, monaco, monospace;">│   └── workstation</span><br /><span style="font-family: terminal, monaco, monospace;">│   ├── pkgsync_amd64</span><br /><span style="font-family: terminal, monaco, monospace;">│   └── pkgsync.default</span><br /><span style="font-family: terminal, monaco, monospace;">└── manifests</span><br /><span style="font-family: terminal, monaco, monospace;">├── init.pp</span><br /><span style="font-family: terminal, monaco, monospace;">└── sources.pp</span></td>
</tr>
</tbody>
</table>
<p><span>Edita el fichero <strong>/etc/puppetlabs/code/environments/production/manifests/site.pp</strong> del servidor puppet:</span></p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;">
<p><span style="font-family: terminal, monaco, monospace;">   node default {</span></p>
<p><span style="font-family: terminal, monaco, monospace;">      include 'apt'</span></p>
<p><span style="font-family: terminal, monaco, monospace;">      package { 'audacity':</span><br /><span style="font-family: terminal, monaco, monospace;">         ensure =&gt; installed,</span><br /><span style="font-family: terminal, monaco, monospace;">      }   </span></p>
<p><span style="font-family: terminal, monaco, monospace;">   }</span></p>
</td>
</tr>
</tbody>
</table>
<p><span>Y realiza el include del módulo <strong>pkgsync</strong> para que este módulo se pueda usar en todos los clientes:</span></p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;">
<p><span style="font-family: terminal, monaco, monospace;">   node default {</span></p>
<p><span style="font-family: terminal, monaco, monospace;">      include 'apt'</span></p>
<p><span style="font-family: terminal, monaco, monospace;">      include 'pkgsync'</span></p>
<p><span style="font-family: terminal, monaco, monospace;">      package { 'audacity':</span><br /><span style="font-family: terminal, monaco, monospace;">         ensure =&gt; installed,</span><br /><span style="font-family: terminal, monaco, monospace;">      }</span></p>
<p><span style="font-family: terminal, monaco, monospace;">   }</span></p>
</td>
</tr>
</tbody>
</table>
<p>A continuación, <strong>inicia </strong><span>la máquina virtual</span><strong><span> </span>xubuntu</strong>,<span> abre un terminal y descarga el archivo <strong>facter.tar.gz</strong><br /></span></p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # wget https://github.com/algodelinux/curso-admonpaquetes/raw/main/facter.tar.gz</span></td>
</tr>
</tbody>
</table>
<p>Una vez descargado, descomprímelo en <strong>/usr/lib/ruby/vendor_ruby/</strong>:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # tar xfvz facter.tar.gz -C /usr/lib/ruby/vendor_ruby/</span></td>
</tr>
</tbody>
</table>
<p><span>Crea el fichero <strong>/etc/escuela.2.0</strong> y a</span><span>ñade "<strong>tipo=workstation</strong>" al fichero <strong>/etc/escuela2.0</strong>:</span></p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # echo 'tipo=workstation' &gt;&gt; /etc/escuela2.0</span></td>
</tr>
</tbody>
</table>
<p>Ejecuta el comando "<b>facter tipo</b>" para comprobar que se obtiene el valor "<strong>workstation</strong>":</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # facter tipo</span><br /><span style="font-family: terminal, monaco, monospace;">   workstation</span></td>
</tr>
</tbody>
</table>
<p>Utiliza scp para copiar el fichero <strong>/etc/pkgsync/musthave </strong>del<strong> cliente</strong> en el directorio <strong>/etc/puppetlabs/code/environments/production/modules/pkgsync/files/workstation/ </strong>del<strong> servidor puppetserver.ies</strong>:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # scp /etc/pkgsync/musthave root@puppetserver.ies:/etc/puppetlabs/code/environments/production/modules/pkgsync/files/workstation/pkgsync_amd64/<br /></span></td>
</tr>
</tbody>
</table>
<p>De este modo, se suministrará el fichero <strong>musthave</strong> que creamos con <strong>musthave-build</strong> en este equipo modelo a todos los clientes puppet cuyo <strong>tipo</strong> sea <strong>workstation</strong>.</p>
<p>Si quieres, comprueba que se ha copiado ejecutando el siguiente comando en el servidor <strong>puppetserver.ies</strong>:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # ls /etc/puppetlabs/code/environments/production/modules/pkgsync/files/workstation/pkgsync_amd64/musthave</span><br /><span style="font-family: terminal, monaco, monospace;">   /etc/puppetlabs/code/environments/production/modules/pkgsync/files/workstation/pkgsync_amd64/musthave</span></td>
</tr>
</tbody>
</table>
<p>Ejecuta el comando "<strong>puppet agent -tv</strong>" en la máquina virtual <strong>xubuntu</strong> para comprobar que todo va bien:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # puppet agent -tv</span></td>
</tr>
</tbody>
</table>
<p>A continuación haz un "<strong>ls -l /etc/apt/sources.list.d/</strong>"  en la máquina virtual <strong>xubuntu</strong> para comprobar que se han añadido los repositorios:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # ls -l /etc/apt/sources.list.d/</span><br /><span style="font-family: terminal, monaco, monospace;">   total 44</span><br /><span style="font-family: terminal, monaco, monospace;">   -rw-r--r-- 1 root root 180 ago 17 13:21 es.archive.ubuntu.com-jammy-backports.list</span><br /><span style="font-family: terminal, monaco, monospace;">   -rw-r--r-- 1 root root 160 ago 17 13:21 es.archive.ubuntu.com-jammy.list</span><br /><span style="font-family: terminal, monaco, monospace;">   -rw-r--r-- 1 root root 176 ago 17 13:21 es.archive.ubuntu.com-jammy-updates.list</span><br /><span style="font-family: terminal, monaco, monospace;">   -rw-r--r-- 1 root root 47 ago 17 13:21 geogebra.list</span><br /><span style="font-family: terminal, monaco, monospace;">   -rw-r--r-- 1 root root 68 ago 17 13:21 google-chrome.list</span><br /><span style="font-family: terminal, monaco, monospace;">   -rw-r--r-- 1 root root 67 ago 17 13:21 google-earth.list</span><br /><span style="font-family: terminal, monaco, monospace;">   -rw-r--r-- 1 root root 178 ago 17 13:21 libreoffice-ubuntu-libreoffice-still-jammy.list</span><br /><span style="font-family: terminal, monaco, monospace;">   -rw-r--r-- 1 root root 162 ago 17 13:21 obsproject-ubuntu-obs-studio-jammy.list</span><br /><span style="font-family: terminal, monaco, monospace;">   -rw-r--r-- 1 root root 164 ago 17 13:21 security.ubuntu.com-jammy.list</span><br /><span style="font-family: terminal, monaco, monospace;">   -rw-r--r-- 1 root root 160 ago 17 13:21 ubuntuhandbook1-ubuntu-gimp-jammy.list</span><br /><span style="font-family: terminal, monaco, monospace;">   -rw-r--r-- 1 root root 162 ago 17 13:21 videolan-ubuntu-master-daily-jammy.list</span><br /><br /></td>
</tr>
</tbody>
</table>
<p>Si tienes algún problema, ponte en contacto con tu tutor.</p></div>
</div>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper pblIdevice em_iDevice em_iDevice_star" id="id250">
<div class="iDevice emphasis1" >
<header class="iDevice_header" style="background-image:url(icon_star.png)"><h1 class="iDeviceTitle">Modifica el módulo pkgsync</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta250_250_2" class="block iDevice_content">
<div class="pbl-task-description"><p>Como los repositorios de Ubuntu que hemos añadido en <strong>/etc/apt/sources.list.d/</strong> ya se encontraban en el fichero <strong>/etc/apt/sources.list</strong>, si realizáis un "<strong>apt update</strong>", se mostrarán errores de duplicidad.</p>
<p>Sitúate en la máquina virtual "<strong>puppetserver"</strong>, añade la siguiente línea al principio del fichero <strong>/etc/puppetlabs/code/environments/production/manifests/site.pp:</strong></p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   class { apt: purge =&gt; { 'sources.list' =&gt; true } }</span></td>
</tr>
</tbody>
</table>
<p>Ésto nos servirá para vaciar el fichero <strong>/etc/apt/sources.list</strong>.</p>
<p>El fichero <strong>/etc/puppetlabs/code/environments/production/manifests/site.pp</strong> quedará tal que así:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;">
<p><span style="font-family: terminal, monaco, monospace;">node default {</span></p>
<p><span style="font-family: terminal, monaco, monospace;">   class { apt: purge =&gt; { 'sources.list' =&gt; true } }</span></p>
<p><span style="font-family: terminal, monaco, monospace;">   include 'apt'</span><br /><span style="font-family: terminal, monaco, monospace;">   include 'pkgsync'</span></p>
<p><span style="font-family: terminal, monaco, monospace;">   package { 'audacity':</span><br /><span style="font-family: terminal, monaco, monospace;">      ensure =&gt; installed,</span><br /><span style="font-family: terminal, monaco, monospace;">   }</span></p>
<p><span style="font-family: terminal, monaco, monospace;">}</span></p>
</td>
</tr>
</tbody>
</table>
<p>A continuación, sitúate en la máquina virtual "<strong>xubuntu</strong>", ejecuta "<strong>puppet agent -tv</strong>" y comprueba que el fichero <strong>/etc/apt/sources.list</strong> tiene el siguiente contenido: "<strong># Repos managed by puppet.</strong>"</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # cat /etc/apt/sources.list</span><br /><span style="font-family: terminal, monaco, monospace;">   # Repos managed by puppet.</span></td>
</tr>
</tbody>
</table>
<p>Vuelve a situarte en la máquina virtual "<strong>puppetserver"</strong> y crea el directorio <strong>musthave.d</strong> en el directorio de ficheros de la máquina <strong>workstation</strong>:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # mkdir /etc/puppetlabs/code/environments/production/modules/pkgsync/files/workstation/pkgsync_amd64/musthave.d</span></td>
</tr>
</tbody>
</table>
<p>Crea un fichero <strong>programacion</strong> dentro del directorio anterior y añádele el nombre del paquete <strong>geany</strong>:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # echo 'geany' &gt;&gt; /etc/puppetlabs/code/environments/production/modules/pkgsync/files/workstation/pkgsync_amd64/musthave.d/programacion</span></td>
</tr>
</tbody>
</table>
<p>A continuación, vuelve a situarte en la máquina virtual <strong>cliente</strong> y ejecuta el comando:</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # puppet agent -tv<br />   Info: Using configured environment 'production'<br />   Info: Retrieving pluginfacts<br />   Info: Retrieving plugin<br />   Info: Retrieving locales<br />   Info: Loading facts<br />   Info: Caching catalog for xubuntu1<br />   Info: Applying configuration version '1692276415'<br />   Notice: /Stage[main]/Pkgsync/File[/etc/pkgsync/musthave.d/programacion]/ensure: defined content as '{md5}02625e0e1fbe2a3084ddf5056190493f'<br />   Notice: Applied catalog in 0.17 seconds<br /></span></td>
</tr>
</tbody>
</table>
<p>Como puedes ver en la salida anterior, se ha creado el fichero <strong>programacion</strong> en directorio <strong>/etc/pkgsync/musthave.d/</strong> del <strong>cliente</strong>.</p>
<p>Si ahora ejecutas pkgsync -pc en el cliente,verás que el paquete <strong>geany</strong> se instala automáticamente.</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # pkgsync -pc</span></td>
</tr>
</tbody>
</table>
<p>Puedes comprobarlo ejecutando un "dpkg -l | grep geany":</p>
<table style="width: 100%;" class="exe-table" border="1">
<tbody>
<tr>
<td style="width: 100%;"><span style="font-family: terminal, monaco, monospace;">   # dpkg -l | grep geany<br />   ii geany 1.38-1 amd64 fast and lightweight IDE<br />   ii geany-common 1.38-1 all fast and lightweight IDE -- common files<br /></span></td>
</tr>
</tbody>
</table>
<p>Si tienes algún problema, ponte en contacto con tu tutor.</p></div>
</div>
</div>
</div>
</div>
</article>
</section>
</div>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="buscar_insertar_y_eliminar_nombres_de_paquetes_en_los_ficheros_de_pkgsync.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="otras_herramientas_incorporadas_en_el_paquete_pkgsync.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
</div>
<p id="made-with-eXe"><a href="https://exelearning.net/" target="_blank" rel="noopener"><span>Creado con eXeLearning<span> (Ventana nueva)</span></span></a></p><script type="text/javascript" src="_style_js.js"></script></body></html>